<div class="modal fade" role="dialog" name="Modal.AdvanceSearch">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title"><i class="fa fa-filter"></i> &nbsp;Advance Search</h4>
            </div>
            <div class="modal-body">
                <div class="row form-horizontal">
                    <fieldset>
                        <div class="form-group">
                            <label class="col-sm-4 control-label">Select an object</label>
                            <div class="col-sm-8">
                                <select class="form-control" name="Select.Object">
                                    <option value="NotSet">- Select Object -</option>
                                    <option value="Agreement">Agreement</option>
                                    <option value="Brand">Brand</option>
                                    <option value="Domain">Domain</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-sm-12">
                            <div class="div-main-filter" style="display: none;">
                                <hr />

                                @Html.Partial("../Shared/_Components/Modals/AdvanceSearch/_Agreement")
                                @Html.Partial("../Shared/_Components/Modals/AdvanceSearch/_Brand")
                                @Html.Partial("../Shared/_Components/Modals/AdvanceSearch/_Domain")
                            </div>
                        </div>
                    </fieldset>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" name="Modal.Button.Search" style="display: none;"><i class="fa fa-search"></i> Search</button>
                <button type="button" data-dismiss="modal"><i class="fa fa-times"></i> Close</button>
            </div>
        </div>
    </div>
</div>

<script src="~/Scripts/Views/Shared/_Components/Modals/AdvanceSearch/_Agreement.js"></script>
<script src="~/Scripts/Views/Shared/_Components/Modals/AdvanceSearch/_Brand.js"></script>
<script src="~/Scripts/Views/Shared/_Components/Modals/AdvanceSearch/_Domain.js"></script>

<script type="text/javascript">
    $(function () {
        $('[name="btnFilter"]').on('click', function () {
            InitModal();

            $('[name="Modal.AdvanceSearch"]').modal('show');
        });

        $('[name="Select.Object"]').on('change', function () {
            var value = $(this).val();

            if (value == 'NotSet') {
                InitModal();
            }
            else {
                $('[name="Modal.Button.Search"], .div-main-filter').show();
            }

            $('.div-filter').hide();

            if (value == 'Agreement') {
                $('[name="Div.AgreementFilter"]').show();
            }
            else if (value == 'Brand') {
                $('[name="Div.BrandFilter"]').show();
            }
            else if (value == 'Domain') {
                $('[name="Div.DomainFilter"]').show();
            }
        });

        $('[name="Modal.Button.Search"]').on('click', function () {
            var query = '?t=1';
            var object = $('[name="Select.Object"]').val();

            if (object == 'NotSet') {
                alert('Please select an object.');
                return;
            }

            if (object == 'Agreement') {
                query = BuildAgreementQuery(query);
            }
            else if (object == 'Brand') {
                query = BuildBrandQuery(query);
            }
            else if (object == 'Domain') {
                query = BuildDomainQuery(query);
            }

            if (query.length == 4) {
                alert('Please select a filter.');
                return;
            }

            window.open(location.origin + '/Search/' + object + '/25/1/' + query, '_self');
        });
    });

    function InitModal() {
        $('[name="Select.Object"]').val('NotSet');

        $('[name="Modal.Button.Search"], .div-main-filter, .div-filter').hide();
    }
</script>
